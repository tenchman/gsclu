#!/bin/sh

TESTFILE=t.c
PATH=/opt/diet/bin:$PATH

rm -f config.h
cat > config.h <<__
/* generated by configure, do not edit! */

__

compile () {
  i386-dietlibc-linux-gcc $TESTFILE -lmatrixssl 2>/dev/null
  if [ $? -eq 0 ]; then
    echo "#define $1 1" >> config.h
  else
    echo "#undef $1" >> config.h
  fi
  rm $TESTFILE
}

cat > $TESTFILE <<__
void main() {
  #include <matrixssl/matrixCommon.h>
  sslChainLen_t chain;
  return 0;
}
__

compile HAS_SSLCHAINLEN_T
